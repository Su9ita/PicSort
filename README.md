# PicSort

ダウンロードフォルダから、ファイル名に含まれる特定の文字列（作者名など）を判別して、画像ファイルを自動的に指定フォルダに振り分けるツールです。

## 機能

- **GUI操作** - 直感的なGUIで簡単に設定・実行
- **柔軟な振り分けルール** - ファイル名に含まれる文字列でマッチング
- **簡単なルール管理** - 追加/編集/削除が簡単
- **手動実行** - ボタン一つで即座に実行
- **定期実行** - Windowsタスクスケジューラで自動化
- **詳細ログ** - 実行結果をリアルタイムで確認
- **重複ファイル対応** - 同名ファイルは自動的にリネーム

## 動作環境

- Windows 10/11
- Python 3.7以上

## インストール

### 1. Python のインストール

Python 3.7以上がインストールされていることを確認してください。

```bash
python --version
```

### 2. プロジェクトのダウンロード

このプロジェクトをダウンロードまたはクローンします。

## 使い方

### 起動方法

`PicSort` フォルダ内で以下のコマンドを実行：

```bash
python main.py
```

### 初期設定

1. **ダウンロード元フォルダの設定**
   - 「フォルダを選択」ボタンをクリック
   - ダウンロードフォルダ（例: `C:\Users\YourName\Downloads`）を選択

2. **振り分けルールの追加**
   - 「追加」ボタンをクリック
   - 「条件（含まれる文字列）」に、ファイル名に含まれる作者名などを入力
     - 例: `artist1_`, `@artist2`, `pixiv_12345678`
   - 「振り分け先フォルダ」で移動先フォルダを選択
   - 「OK」をクリック

3. **実行**
   - 「今すぐ実行」ボタンをクリック
   - ログに実行結果が表示されます

### 振り分けルールの例

| 条件（含まれる文字列） | 振り分け先フォルダ | 説明 |
|-------------------|---------------|------|
| `artist1_` | `D:\Images\Artist1` | ファイル名に`artist1_`を含むファイルをArtist1フォルダへ |
| `@artist2` | `D:\Images\Artist2` | ファイル名に`@artist2`を含むファイルをArtist2フォルダへ |
| `_illust_` | `D:\Images\Illustrations` | ファイル名に`_illust_`を含むファイルをIllustrationsフォルダへ |

### ルールの編集・削除

- **編集**: ルールを選択して「編集」ボタンをクリック
- **削除**: ルールを選択して「削除」ボタンをクリック

## 定期実行の設定（Windowsタスクスケジューラ）

自動的に定期実行するには、Windowsタスクスケジューラを使用します。

### 1. タスクスケジューラを開く

- Windows検索で「タスク スケジューラ」と入力して起動

### 2. 基本タスクを作成

1. 右側の「基本タスクの作成」をクリック
2. 名前: `PicSort`
3. トリガー: 「毎日」を選択
4. 開始日時と実行間隔を設定（例: 1日3回実行したい場合）
5. 操作: 「プログラムの開始」を選択
6. プログラム/スクリプト: Pythonのパス（例: `C:\Python39\python.exe`）
7. 引数の追加: `main.py`
8. 開始: `PicSort`フォルダのフルパス（例: `E:\GenerativeAI\ClaudeCode\PicSort`）

### 3. 複数回実行する場合

1日に複数回実行したい場合：

1. 作成したタスクを右クリック → 「プロパティ」
2. 「トリガー」タブで「編集」
3. 「詳細設定」で「繰り返し間隔」を設定（例: 8時間ごと）
4. 「有効期限」を1日に設定

### バックグラウンド実行用スクリプト（オプション）

GUIウィンドウを表示せずに実行したい場合、以下の `run_silent.pyw` を作成：

```python
from organizer import Config, FileOrganizer

config = Config()
organizer = FileOrganizer(config)
organizer.organize()
```

タスクスケジューラで `run_silent.pyw` を指定すると、バックグラウンドで実行されます。

## 設定ファイル

設定は `config.json` に自動保存されます。

```json
{
  "source_folder": "C:/Users/YourName/Downloads",
  "mappings": [
    {
      "pattern": "artist1_",
      "destination": "D:/Images/Artist1"
    },
    {
      "pattern": "@artist2",
      "destination": "D:/Images/Artist2"
    }
  ]
}
```

## 注意事項

- **バックアップ**: 初めて使用する際は、重要なファイルのバックアップを取ることをおすすめします
- **同名ファイル**: 移動先に同名のファイルがある場合、`filename_1.ext`のように自動的にリネームされます
- **パターンの優先順位**: 複数のルールにマッチする場合、最初にマッチしたルールが適用されます
- **ファイルの移動**: ファイルはコピーではなく移動（カット&ペースト）されます

## トラブルシューティング

### アプリが起動しない

- Pythonが正しくインストールされているか確認
- コマンドプロンプトで `python main.py` を実行してエラーメッセージを確認

### ファイルが移動されない

- ソースフォルダのパスが正しいか確認
- 振り分けルールの条件が正しいか確認（大文字小文字も区別されます）
- ログを確認してエラーメッセージをチェック

### 定期実行が動かない

- タスクスケジューラでタスクの履歴を確認
- Pythonのパスとスクリプトのパスが正しいか確認
- 「開始」欄にプロジェクトフォルダのパスが設定されているか確認

## ライセンス

MIT License
